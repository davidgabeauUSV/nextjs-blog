{"ast":null,"code":"import { useEffect } from 'react';\nimport Router from 'next/router';\nimport useSWR from 'swr';\n\nconst fetcher = url => fetch(url).then(r => r.json()).then(data => {\n  return {\n    user: (data === null || data === void 0 ? void 0 : data.user) || null\n  };\n});\n\nexport function useUser({\n  redirectTo,\n  redirectIfFound\n} = {}) {\n  const {\n    data,\n    error\n  } = useSWR('/api/user', fetcher);\n  const user = data === null || data === void 0 ? void 0 : data.user;\n  const finished = Boolean(data);\n  const hasUser = Boolean(user);\n  useEffect(() => {\n    if (!redirectTo || !finished) return;\n\n    if ( // If redirectTo is set, redirect if the user was not found.\n    redirectTo && !redirectIfFound && !hasUser || // If redirectIfFound is also set, redirect if the user was found\n    redirectIfFound && hasUser) {\n      Router.push(redirectTo);\n    }\n  }, [redirectTo, redirectIfFound, finished, hasUser]);\n  return error ? null : user;\n}","map":{"version":3,"sources":["/Users/davidgabeau/Desktop/glo/nextjs-blog/with-magic-app/lib/hooks.js"],"names":["useEffect","Router","useSWR","fetcher","url","fetch","then","r","json","data","user","useUser","redirectTo","redirectIfFound","error","finished","Boolean","hasUser","push"],"mappings":"AAAA,SAASA,SAAT,QAA0B,OAA1B;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,OAAOC,MAAP,MAAmB,KAAnB;;AAEA,MAAMC,OAAO,GAAGC,GAAG,IACjBC,KAAK,CAACD,GAAD,CAAL,CACGE,IADH,CACQC,CAAC,IAAIA,CAAC,CAACC,IAAF,EADb,EAEGF,IAFH,CAEQG,IAAI,IAAI;AACZ,SAAO;AAAEC,IAAAA,IAAI,EAAE,CAAAD,IAAI,SAAJ,IAAAA,IAAI,WAAJ,YAAAA,IAAI,CAAEC,IAAN,KAAc;AAAtB,GAAP;AACD,CAJH,CADF;;AAOA,OAAO,SAASC,OAAT,CAAiB;AAAEC,EAAAA,UAAF;AAAcC,EAAAA;AAAd,IAAkC,EAAnD,EAAuD;AAC5D,QAAM;AAAEJ,IAAAA,IAAF;AAAQK,IAAAA;AAAR,MAAkBZ,MAAM,CAAC,WAAD,EAAcC,OAAd,CAA9B;AACA,QAAMO,IAAI,GAAGD,IAAH,aAAGA,IAAH,uBAAGA,IAAI,CAAEC,IAAnB;AACA,QAAMK,QAAQ,GAAGC,OAAO,CAACP,IAAD,CAAxB;AACA,QAAMQ,OAAO,GAAGD,OAAO,CAACN,IAAD,CAAvB;AAEAV,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACY,UAAD,IAAe,CAACG,QAApB,EAA8B;;AAC9B,SACE;AACCH,IAAAA,UAAU,IAAI,CAACC,eAAf,IAAkC,CAACI,OAApC,IACA;AACCJ,IAAAA,eAAe,IAAII,OAJtB,EAKE;AACAhB,MAAAA,MAAM,CAACiB,IAAP,CAAYN,UAAZ;AACD;AACF,GAVQ,EAUN,CAACA,UAAD,EAAaC,eAAb,EAA8BE,QAA9B,EAAwCE,OAAxC,CAVM,CAAT;AAYA,SAAOH,KAAK,GAAG,IAAH,GAAUJ,IAAtB;AACD","sourcesContent":["import { useEffect } from 'react'\nimport Router from 'next/router'\nimport useSWR from 'swr'\n\nconst fetcher = url =>\n  fetch(url)\n    .then(r => r.json())\n    .then(data => {\n      return { user: data?.user || null }\n    })\n\nexport function useUser({ redirectTo, redirectIfFound } = {}) {\n  const { data, error } = useSWR('/api/user', fetcher)\n  const user = data?.user\n  const finished = Boolean(data)\n  const hasUser = Boolean(user)\n\n  useEffect(() => {\n    if (!redirectTo || !finished) return\n    if (\n      // If redirectTo is set, redirect if the user was not found.\n      (redirectTo && !redirectIfFound && !hasUser) ||\n      // If redirectIfFound is also set, redirect if the user was found\n      (redirectIfFound && hasUser)\n    ) {\n      Router.push(redirectTo)\n    }\n  }, [redirectTo, redirectIfFound, finished, hasUser])\n\n  return error ? null : user\n}\n"]},"metadata":{},"sourceType":"module"}